{"version":3,"sources":["../../../../../src/features/commenting/components/input/AddCommentBox.tsx"],"sourcesContent":["'use client'\n\nimport type { LexicalEditor, NodeKey } from '@payloadcms/richtext-lexical/lexical'\n\nimport React, { useCallback, useEffect, useLayoutEffect , useRef } from 'react'\n\ntype AddCommentBoxProps = {\n  anchorKey: NodeKey\n  editor: LexicalEditor\n  onAddComment: () => void\n}\n\nexport const AddCommentBox: React.FC<AddCommentBoxProps> = ({\n  anchorKey,\n  editor,\n  onAddComment,\n}) => {\n  const boxRef = useRef<HTMLDivElement>(null)\n\n  const updatePosition = useCallback(() => {\n    const boxElem = boxRef.current\n    const rootElement = editor.getRootElement()\n    const anchorElement = editor.getElementByKey(anchorKey)\n\n    if (boxElem !== null && rootElement !== null && anchorElement !== null) {\n      const { right } = rootElement.getBoundingClientRect()\n      const { top } = anchorElement.getBoundingClientRect()\n      boxElem.style.left = `${right - 20}px`\n      boxElem.style.top = `${top - 30}px`\n    }\n  }, [anchorKey, editor])\n\n  useEffect(() => {\n    window.addEventListener('resize', updatePosition)\n\n    return () => {\n      window.removeEventListener('resize', updatePosition)\n    }\n  }, [editor, updatePosition])\n\n  useLayoutEffect(() => {\n    updatePosition()\n  }, [anchorKey, editor, updatePosition])\n\n  return (\n    <div className=\"CommentPlugin_AddCommentBox\" ref={boxRef}>\n      <button\n        aria-label=\"Add comment\"\n        className=\"CommentPlugin_AddCommentBox_button\"\n        onClick={onAddComment}\n      >\n        <i className=\"icon add-comment\" />\n      </button>\n    </div>\n  )\n}\n"],"names":["React","useCallback","useEffect","useLayoutEffect","useRef","AddCommentBox","anchorKey","editor","onAddComment","boxRef","updatePosition","boxElem","current","rootElement","getRootElement","anchorElement","getElementByKey","right","getBoundingClientRect","top","style","left","window","addEventListener","removeEventListener","div","className","ref","button","aria-label","onClick","i"],"mappings":"AAAA;;AAIA,OAAOA,SAASC,WAAW,EAAEC,SAAS,EAAEC,eAAe,EAAGC,MAAM,QAAQ,QAAO;AAQ/E,OAAO,MAAMC,gBAA8C,CAAC,EAC1DC,SAAS,EACTC,MAAM,EACNC,YAAY,EACb;IACC,MAAMC,SAASL,OAAuB;IAEtC,MAAMM,iBAAiBT,YAAY;QACjC,MAAMU,UAAUF,OAAOG,OAAO;QAC9B,MAAMC,cAAcN,OAAOO,cAAc;QACzC,MAAMC,gBAAgBR,OAAOS,eAAe,CAACV;QAE7C,IAAIK,YAAY,QAAQE,gBAAgB,QAAQE,kBAAkB,MAAM;YACtE,MAAM,EAAEE,KAAK,EAAE,GAAGJ,YAAYK,qBAAqB;YACnD,MAAM,EAAEC,GAAG,EAAE,GAAGJ,cAAcG,qBAAqB;YACnDP,QAAQS,KAAK,CAACC,IAAI,GAAG,GAAGJ,QAAQ,GAAG,EAAE,CAAC;YACtCN,QAAQS,KAAK,CAACD,GAAG,GAAG,GAAGA,MAAM,GAAG,EAAE,CAAC;QACrC;IACF,GAAG;QAACb;QAAWC;KAAO;IAEtBL,UAAU;QACRoB,OAAOC,gBAAgB,CAAC,UAAUb;QAElC,OAAO;YACLY,OAAOE,mBAAmB,CAAC,UAAUd;QACvC;IACF,GAAG;QAACH;QAAQG;KAAe;IAE3BP,gBAAgB;QACdO;IACF,GAAG;QAACJ;QAAWC;QAAQG;KAAe;IAEtC,qBACE,KAACe;QAAIC,WAAU;QAA8BC,KAAKlB;kBAChD,cAAA,KAACmB;YACCC,cAAW;YACXH,WAAU;YACVI,SAAStB;sBAET,cAAA,KAACuB;gBAAEL,WAAU;;;;AAIrB,EAAC"}