{"version":3,"sources":["../../../../src/features/commenting/utils/api.ts"],"sourcesContent":["'use client'\n\nimport type { ErrorResponse, PayloadAPIResponse } from '../types/api.js'\n\nimport { Logger } from './logger.js'\n\n/**\n * Utility class for handling API requests\n */\nexport class APIUtils {\n  /**\n   * Create a standard error response\n   * @param message The error message\n   * @param details Additional error details\n   * @returns A standardized error object\n   */\n  static createErrorResponse(message: string, details?: Record<string, unknown>): ErrorResponse {\n    return {\n      error: message,\n      ...(details ? { details } : {})\n    }\n  }\n  \n  /**\n   * Make a DELETE request to the API\n   * @param endpoint The API endpoint\n   * @returns The response data\n   */\n  static async delete<T>(endpoint: string): Promise<T> {\n    try {\n      // Make the request\n      const response = await fetch(endpoint, {\n        method: 'DELETE',\n      })\n      \n      // Handle errors\n      if (!response.ok) {\n        throw new Error(`API error: ${response.status} ${response.statusText}`)\n      }\n      \n      // Parse and return the response\n      return await response.json()\n    } catch (error) {\n      Logger.error(`Error deleting ${endpoint}:`, error)\n      throw error\n    }\n  }\n  \n  /**\n   * Make a GET request to the API\n   * @param endpoint The API endpoint\n   * @param params Query parameters\n   * @returns The response data\n   */\n  static async get<T>(endpoint: string, params?: Record<string, string>): Promise<T> {\n    try {\n      // Build the URL with query parameters\n      const url = new URL(endpoint, window.location.origin)\n      if (params) {\n        Object.entries(params).forEach(([key, value]) => {\n          url.searchParams.append(key, value)\n        })\n      }\n      \n      // Make the request\n      const response = await fetch(url.toString())\n      \n      // Handle errors\n      if (!response.ok) {\n        throw new Error(`API error: ${response.status} ${response.statusText}`)\n      }\n      \n      // Parse and return the response\n      return await response.json()\n    } catch (error) {\n      Logger.error(`Error fetching from ${endpoint}:`, error)\n      throw error\n    }\n  }\n  \n  /**\n   * Get Payload API response with pagination\n   * @param endpoint The API endpoint\n   * @param params Query parameters\n   * @returns The paginated response\n   */\n  static async getPaginated<T>(\n    endpoint: string, \n    params?: Record<string, string>\n  ): Promise<PayloadAPIResponse<T>> {\n    return this.get<PayloadAPIResponse<T>>(endpoint, params)\n  }\n  \n  /**\n   * Make a PATCH request to the API\n   * @param endpoint The API endpoint\n   * @param data The request body\n   * @returns The response data\n   */\n  static async patch<T, D = Record<string, unknown>>(endpoint: string, data: D): Promise<T> {\n    try {\n      // Make the request\n      const response = await fetch(endpoint, {\n        body: JSON.stringify(data),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        method: 'PATCH',\n      })\n      \n      // Handle errors\n      if (!response.ok) {\n        throw new Error(`API error: ${response.status} ${response.statusText}`)\n      }\n      \n      // Parse and return the response\n      return await response.json()\n    } catch (error) {\n      Logger.error(`Error patching ${endpoint}:`, error)\n      throw error\n    }\n  }\n  \n  /**\n   * Make a POST request to the API\n   * @param endpoint The API endpoint\n   * @param data The request body\n   * @returns The response data\n   */\n  static async post<T, D = Record<string, unknown>>(endpoint: string, data: D): Promise<T> {\n    try {\n      // Make the request\n      const response = await fetch(endpoint, {\n        body: JSON.stringify(data),\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        method: 'POST',\n      })\n      \n      // Handle errors\n      if (!response.ok) {\n        throw new Error(`API error: ${response.status} ${response.statusText}`)\n      }\n      \n      // Parse and return the response\n      return await response.json()\n    } catch (error) {\n      Logger.error(`Error posting to ${endpoint}:`, error)\n      throw error\n    }\n  }\n}\n"],"names":["Logger","APIUtils","createErrorResponse","message","details","error","delete","endpoint","response","fetch","method","ok","Error","status","statusText","json","get","params","url","URL","window","location","origin","Object","entries","forEach","key","value","searchParams","append","toString","getPaginated","patch","data","body","JSON","stringify","headers","post"],"mappings":"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"}